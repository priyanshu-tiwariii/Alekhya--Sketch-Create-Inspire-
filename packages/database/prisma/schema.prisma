generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// User Table
model User {
  id            String         @id @default(uuid()) 
  createdAt     DateTime       @default(now())
  email         String         @unique
  name          String?
  userName      String         @unique 
  bio           String?
  profilePhoto  String?
  provider      String
  createdFiles  CreatedFile[]  @relation("CreatedFiles")
  collaborations Collaborator[] @relation("UserCollaborations")
}

model CreatedFile {
  id            String          @id @default(uuid())  // Renamed file_id to id for consistency
  createdAt     DateTime        @default(now())
  createdByUser User            @relation("CreatedFiles", fields: [createdByUserId], references: [id])
  createdByUserId String
  strokes       Stroke[]        @relation("Strokes")
  collaborators Collaborator[]  @relation("Collaborators")
}


model Stroke {
  id            String       @id @default(uuid())   // Renamed stroke_id to id
  file          CreatedFile  @relation("Strokes", fields: [fileId], references: [id])
  fileId        String
  data          Json         
  createdAt     DateTime     @default(now())
}


enum Role {
  ADMIN
  USER
  EDITOR
}

model Collaborator {
  id            String       @id @default(uuid())
  file          CreatedFile  @relation("Collaborators", fields: [fileId], references: [id])
  fileId        String
  user          User         @relation("UserCollaborations",fields: [userId], references: [id])
  userId        String
  role          Role         @default(USER)    
  joinedAt      DateTime     @default(now())
}
